<%- unless ons_statistics.blank? || ons_statistics.values.flatten.compact.empty? -%>

  <div id="ons_statistics" class="item_grouping">
    <h3>About this area</h3>
    <%= render :partial => 'shared/experimental_flash' %>
    
    <%- ons_statistics.each do |group, datapoints| -%>
      <%- next if datapoints.blank? -%>
      
      <%- if group.display_as == "in_words" -%>
        <div id="misc" class="stats_in_words">
          <%= ons_statistics_in_words(:misc => datapoints) %>
        </div>
      <%- else -%>
        <%- content_tag :div, :class => "datapoint_grouping #{group.title} #{(group.display_as=="graph") ? 'graphed_datapoints' : ''}" do -%>
          <%- content_tag :table do -%>
            <caption><%= group.title.titleize %></caption>
            <tr>
                <th>Description</th>
                <th class="value">Value</th>
            </tr>

            <%- for datapoint in datapoints -%>
              <tr class="datapoint">
                <td class="description"><%= link_to(datapoint.short_title, datapoint) %></td>
                <td class="value"><%= formatted_datapoint_value(datapoint) %></td>
              </tr>
            <%- end -%>
          
          <%- end -%>
          <%- if group.display_as == "graph" -%>
            <div id="religion_graph" class="graph">
              <h4>Religion</h4>
              <%= ons_statistics_graph(group => datapoints) %>
            </div>
          <%- end -%>
        <%- end -%>
      <%- end -%>
    <%- end -%>
  </div>
<%- end -%>
