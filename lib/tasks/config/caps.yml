---
portal_system_name: CAPS (Public Access)
 
councils:
  angus: http://planning.angus.gov.uk/PublicAccess/
  barking and dagenham: http://paweb.barking-dagenham.gov.uk/publicaccess/
  basildon: http://planning.basildon.gov.uk/publicaccess/tdc/dcapplication/
  bexley: http://publicaccess.bexley.gov.uk/publicaccess/
  bromsgrove: http://appuview.bromsgrove.gov.uk/publicaccess/tdc/dcapplication/ 
  chiltern: https://isa.chiltern.gov.uk/publicaccess/
  doncaster: http://local.doncaster.gov.uk/publicaccess/
  dundee: http://bwarrant.dundeecity.gov.uk/publicaccess/
  east northamptonshire: http://publicaccesssrv.east-northamptonshire.gov.uk/publicaccess/
  fenland: http://www.fenland.gov.uk/publicaccess/
  hammersmith and fulham: http://www.apps.lbhf.gov.uk/PublicAccess/
  hinckley and bosworth: https://cx.hinckley-bosworth.gov.uk/publicaccess/
  knowsley: http://publicaccess.knowsley.gov.uk/publicaccess/
  luton: http://www.eplan.luton.gov.uk/publicaccess/
  melton: http://publicaccess.melton.gov.uk/PALiveSystem77/
  oadby and wigston: http://pa.owbc.net/PublicAccess/
  redditch: http://access.redditchbc.gov.uk/PublicAccess/
  rochford: http://publicaccess.rochford.gov.uk/publicaccess/
  sandwell: http://webcaps.sandwell.gov.uk/publicaccess/
  selby: http://publicaccess.selby.gov.uk/publicaccess/
  sheffield: http://planning.sheffield.gov.uk/publicaccess/
  south bucks: http://sbdc-paweb.southbucks.gov.uk/publicaccess/
  southampton: http://publicaccess.southampton.gov.uk/publicaccess/
  southend on sea: http://planning.southend.gov.uk/publicaccess/
  spelthorne: http://phoenix.spelthorne.gov.uk/publicaccess/
  staffordshire moorlands: http://publicaccess.staffsmoorlands.gov.uk/publicaccess/
  swindon: http://195.89.201.121/PublicAccess77/
  waveney: http://publicaccess.waveney.gov.uk/pasystem77/
  west lancashire: http://publicaccess.westlancs.gov.uk/publicaccess/

#------------------------------------------------------------------------------

item:
  http_method:      POST
  encoding:         UTF-8
  parsing_library:  8
  item_parser:      item.search('table.cResultsForm tr')[1..-1]
  
  # From OpenlyLocal  
  
  # path: DcApplication/application_searchresults.aspx?searchtype=ADV&tpage=1&pagesize=100&srchDateValidStart=#{14.days.ago.to_date.to_s(:uk)}&srchDateValidEnd=#{Date.today.to_s(:uk)}
  
  # Modified to use dd/mm/yyyy dates
  
  path: tdc/DcApplication/application_searchresults.aspx?searchtype=ADV&srchDateValidStart=#{14.days.ago.to_date.strftime("%d/%m/%Y")}&srchDateValidEnd=#{Date.today.strftime("%d/%m/%Y")}
  
  
  # From Planning Alerts 1.0
  
  # path: DcApplication/application_searchresults.aspx?searchtype=WEEKLY&selWeeklyListRange=01/12/2011|20/12/2011&weektype=VAL
  
  attributes: 
    url:  base_url + item.search('td a').last[:href].sub(/^\/\w+\//,'')
    uid:  item.at('td').inner_text

#------------------------------------------------------------------------------
    
info:
  http_method:      GET
  encoding:         UTF-8
  parsing_library:  8
  item_parser:      item.at("body")
  
  fields:
    - :parser:    item.at("textarea#address").inner_text
      :name:      address
      :required:  true
  
    - :parser:    item.at("textarea#desc").inner_text
      :name:      description
      :required:  true
  
    - :parser:    item.at("input#daterecv")["value"]
      :name:      date_received
      :required:  false
  #     
  #   - :parser:    item.at("input#dateeiareceived")["value"]
  #     :name:      date_eia_received
  #     :required:  false
    
    - :parser:    item.at("input#applicantname")["value"]
      :name:      applicant_name
      :required:  false  
      
    - :parser:    item.at("textarea#applicantaddress").try(:inner_text)
      :name:      applicant_address
      :required:  false
    
    - :parser:    item.at("input#applicationstatus")["value"]
      :name:      status
      :required:  false
    
  #   - :parser:    item.at("textarea#datevalid").inner_text???????????????
  #     :name:      on_notice_from
  #     :required:  false
      
  #   - :parser:    item.at("textarea#dateexpiry").inner_text
  #     :name:      on_notice_to
  #     :required:  false
